# copyright (c) 2026 @squid consultancy group (scg)
# all rights reserved.
# licensed under the mit license.

# NVDetect Nano Configuration for Neurova
# Single-stage anchor-free object detector

name: nvdetect_nano
version: 1.0.0
framework: onnx
type: detection
description: NVDetect Nano - Ultrafast single-stage object detector

# Model variants
variants:
  - name: nvdetect_nano
    size: nano
    params: 3.5M
  - name: nvdetect_small
    size: small
    params: 12.0M
  - name: nvdetect_medium
    size: medium
    params: 28.0M
  - name: nvdetect_large
    size: large
    params: 48.0M
  - name: nvdetect_xlarge
    size: xlarge
    params: 72.0M

# Model files
files:
  onnx: nvdetect_nano.onnx
  tensorrt: nvdetect_nano.engine
  openvino_xml: nvdetect_nano.xml
  openvino_bin: nvdetect_nano.bin
  ncnn_param: nvdetect_nano.param
  ncnn_bin: nvdetect_nano.bin

# Input specification
input:
  name: images
  shape: [1, 3, 640, 640]
  dtype: float32
  format: NCHW
  color_order: RGB

  preprocessing:
    resize:
      width: 640
      height: 640
      interpolation: bilinear
      letterbox: true # Maintain aspect ratio with padding
      padding_value: 114
    normalize:
      scale: 255.0 # Divide by 255 only, no mean/std
      mean: [0.0, 0.0, 0.0]
      std: [1.0, 1.0, 1.0]

# Output specification
output:
  - name: output0
    shape: [1, 85, 8400] # [batch, 5+80, predictions]
    dtype: float32

# Detection post-processing
postprocess:
  type: single_stage
  conf_threshold: 0.25
  iou_threshold: 0.45
  max_detections: 300

  # Anchor-free detection
  strides: [8, 16, 32]

  # Box decoding
  box_format: xyxy # x1, y1, x2, y2

  # NMS parameters
  nms:
    type: batched # regular, batched, or soft
    class_agnostic: false

# Class labels
labels:
  file: coco_labels.txt
  format: text
  num_classes: 80

# Training info
training:
  dataset: COCO
  epochs: 500
  batch_size: 96
  optimizer: SGD
  lr: 0.01
  augmentation:
    - mosaic
    - mixup
    - copy_paste

# Performance benchmarks
benchmarks:
  gpu_v100:
    latency_ms: 1.5
    throughput_fps: 667
  gpu_rtx3080:
    latency_ms: 1.2
    throughput_fps: 833
  cpu_i9:
    latency_ms: 45
    throughput_fps: 22

# Hardware optimizations
optimizations:
  cuda:
    use_cudnn: true
    tensor_cores: true
    precision: fp16
  tensorrt:
    use_dla: false
    precision: fp16
    workspace_mb: 1024
  opencl:
    work_group_size: [16, 16]

# Evaluation metrics
metrics:
  coco_map: 0.38
  coco_map50: 0.54
  coco_map75: 0.41

# Metadata
metadata:
  author: Squid Consultancy Group (SCG)
  license: MIT
  source: neurova
